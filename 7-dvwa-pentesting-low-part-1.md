# Manual Pentesting: DVWA Modules
## Objective
To validate the OWASP ZAP scan results, observe how the web app reacts, and potentially uncover new vulnerabilities.

---
## Side Effect of ZAP Scan: Password Reset
During a ZAP scan with DVWA set to Low security, the scanner accessed `/vulnerabilities/csrf/`, submitting the form that changes the `admin` password.

- **Result**: `admin` password was reset to an empty string
- **Detection**: Verified in MySQL where the password hash was `d41d8cd98f00b204e9800998ecf8427e`
- **Fix**: Manual SQL update to restore default password with 
```sql
UPDATE users SET password = MD5('password') WHERE user = 'admin';
```

___
## SQL Injection

**Expected behavior**: return the first and last name of the user with the matching input ID

![[7_1.png]]

**Payload: `' OR '1'='1`**
- Meaning: always true boolean
- Result: returned all of the users' first and last names (success)

![[7_2.png]]

**Payload: `' OR 1=1--`**
- Meaning: boolean bypass + comment out the rest
- Result: blank screen

![[7_3.png]]
- Likely caused an error due to unmatched quotes, assuming the backend query is something like:
```sql
SELECT * FROM users WHERE id = '$id';
```

**Payload: `1' OR 'a'='a`**
- Meaning: always true boolean
- Result: returned all of the users' first and last names (success)

![[7_4.png]]

**Payload: `1' AND '1'='2**
- Meaning: always false boolean
- Result: returned no results, confirmed the logic of the underlying SQL

![[7_5.png]]

___

## XSS (Reflected)

**Expected behavior**:  show the message "Hello" followed by a space and the input string

![[7_6.png]]

**Payload: `<script>alert(1)</script>
- Meaning: basic alert with message "1"
- Result: triggered a pop-up, then showed the message "Hello" when dismissed

![[7_7.png]]
![[7_8.png]]

**Payload: `<img src=x onerror=alert(1)>`**
- Meaning: alert triggered by an image error
- Result: triggered a pop-up with message "1" (like the previous payload), then showed an image icon on the page when the alert was dismissed

![[7_9.png]]

___
## Brute Force (Burp Suite)
After Hydra was unable to bypass DVWA's authentication, I switched to Burp Suite Community Edition, which is more focused on testing web applications.
### Steps
- Configured Firefox to proxy HTTP/HTTPS through Burp (127.0.0.1:8080)
- Logged into DVWA and navigated to the Brute Force module 
- Enabled **Intercept** under Burp Suite's Proxy tab
- Submitted a fake login on the DVWA brute force form
- Intercepted a GET request containing credentials in the URL
- Sent captured request to **Intruder**
#### Intruder Setup
- Attack type: **Sniper**
- Payload position: password field
- Payload list: passwords from`rockyou.txt`
### Result
I paused the attack before every password was tried after noticing that:
- All failed attempts returned length 5030 (with a few 5029 at the beginning) which can be confirmed by sorted the Length column
- The correct password `password` returned length 5073

![[7_10.png]]

Reviewing the HTML under the Response tab showed a different message confirming login
- `password` results in a welcome message at line 92
- incorrect passwords show a failure message 

![[7_11.png]]
![[7_12.png]]

Confirmation on the web app:

![[7_13.png]]
### Detection (Splunk)
#### Query:
```
index=main sourcetype=access_combined uri_path="/DVWA/vulnerabilities/brute/"
| stats count dc(password) by clientip, username
| where count > 10 AND 'dc(password)' > 10
```
Explanation
- `count`:  total requests to the DVWA brute force module
- `dc(password)`: how many **distinct** passwords were tried
- Filter for IPs who made more than 10 total requests with more than 10 different passwords to excluding normal users who may have mistyped

![[7_14.png]]
Unlike Hydra, Burp Suite did not appear under a suspicious user agent. However, we can see that Kali tried 141 different passwords for the `admin` username, indicating a brute force attack.